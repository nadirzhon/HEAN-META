# Расчет для получения 5 сделок за 10 дней

## Текущая ситуация

1. Частота тиков: 1 тик/секунду на символ
2. Символы: 2 (BTCUSDT, ETHUSDT)
3. За 10 дней: 864,000 тиков на символ (10 дней × 24 часа × 3600 секунд)
4. Текущий `_force_signal_interval = 300000`

## Расчет

- На один символ за 10 дней: 864,000 / 300,000 = 2.88 сигнала
- На оба символа: 2.88 × 2 = 5.76 сигнала ≈ 5–6 сделок

## Проблемы, которые могут снизить количество сделок

1. Проверка `symbol not in self._open_positions` (строка 132) — если позиция открыта, сигнал не генерируется
2. Проверка `_check_no_trade_zone` (строка 138) — может блокировать по спреду
3. Позиции могут быть открыты часть времени, что снижает количество новых сигналов

## Минимальные изменения для гарантированных 5 сделок

### Вариант 1: Увеличить интервал (если сделок больше 5)

```python
# В src/hean/strategies/impulse_engine.py, строка 78
# Для ровно 5 сделок на 2 символа: 864,000 / 2.5 = 345,600
self._force_signal_interval = 345600  # Force signal every 345.6k ticks (~2.5 дня на символ)
```

### Вариант 2: Уменьшить интервал (если сделок меньше 5)

```python
# Если позиции открыты долго, уменьшить интервал
self._force_signal_interval = 250000  # Force signal every 250k ticks (~1.7 дня на символ)
# Это даст: 864,000 / 250,000 = 3.46 сигнала на символ = 6.92 на оба ≈ 6-7 сделок
```

### Вариант 3: Убрать проверку открытых позиций (если нужно больше сделок)

```python
# В src/hean/strategies/impulse_engine.py, строка 132
# Убрать проверку symbol not in self._open_positions для принудительных сигналов
if self._tick_count[symbol] % self._force_signal_interval == 0:
    logger.info(f"[FORCED_SIGNAL] Forcing signal for {symbol} (tick {self._tick_count[symbol]})")
    await self._force_signal(tick)
    return
```

### Вариант 4: Отключить проверку спреда для принудительных сигналов

```python
# В методе _force_signal добавить обход проверки спреда
# Или изменить _check_no_trade_zone, чтобы не блокировать принудительные сигналы
```

## Рекомендация

Начните с варианта 1: установите `_force_signal_interval = 345600`. Это даст примерно 5 сделок за 10 дней. Если сделок будет меньше 5, уменьшите до 250000–280000. Если больше 5, увеличьте до 400000.

Также проверьте, не блокирует ли `_check_no_trade_zone` принудительные сигналы по спреду — это может снижать количество сделок.





