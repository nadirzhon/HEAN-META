# –û–¢–ß–ï–¢ –û –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø–•

**–î–∞—Ç–∞:** 2025-01-03  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã

---

## –ö–†–ê–¢–ö–û: –ß–¢–û –ë–´–õ–û –°–õ–û–ú–ê–ù–û

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-–∫–æ–¥–µ:

1. **–î–í–û–ô–ù–´–ï –û–†–î–ï–†–ê** - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `orderLinkId` –¥–ª—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –æ—Ä–¥–µ—Ä–æ–≤ –ø—Ä–∏ —Ä–µ—Ç—Ä–∞—è—Ö
2. **MUTABLE DEFAULTS** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `metadata: dict = {}` –≤ Pydantic –º–æ–¥–µ–ª—è—Ö –≤—ã–∑—ã–≤–∞–ª–æ —É—Ç–µ—á–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–∞–º–∏
3. **MEMORY LEAK –í EVENTBUS** - –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å–æ–±—ã—Ç–∏–π –º–æ–≥–ª–∞ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—Ç–µ—á–∫–∞–º –ø–∞–º—è—Ç–∏
4. **–ë–õ–û–ö–ò–†–û–í–ö–ê EVENT LOOP** - –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –Ω–∞–ø—Ä—è–º—É—é, –±–ª–æ–∫–∏—Ä—É—è event loop
5. **–ó–ê–•–ê–†–î–ö–û–ñ–ï–ù–ù–´–ï SYMBOL RULES** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
6. **–ù–ï–ß–ï–¢–ö–ê–Ø –ì–†–ê–ù–ò–¶–ê SIMULATION/LIVE** - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —è–≤–Ω—ã—Ö –∑–∞—â–∏—Ç–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–∞—Ö

---

## –°–ü–ò–°–û–ö –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### ‚úÖ 1. –ò–î–ï–ú–ü–û–¢–ï–ù–¢–ù–û–°–¢–¨ –û–†–î–ï–†–û–í (orderLinkId)

**üìç –§–∞–π–ª:** `src/hean/exchange/bybit/http.py`

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞:**  
–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `orderLinkId` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ä–¥–µ—Ä–æ–≤ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –ø—Ä–∏ —Ä–µ—Ç—Ä–∞—è—Ö —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫.

**üí• –†–∏—Å–∫:**  
–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–≥–æ –∂–µ –æ—Ä–¥–µ—Ä–∞ –ø—Ä–∏ —Å–µ—Ç–µ–≤–æ–π –æ—à–∏–±–∫–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –¥–≤–æ–π–Ω–æ–º—É –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –ø–æ—Ç–µ—Ä—è–º.

**‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ orderLinkId –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
order_link_id = (
    f"{order_request.strategy_id}_{order_request.symbol}_"
    f"{int(time.time() * 1000)}_{uuid.uuid4().hex[:8]}"
)

bybit_params = {
    # ... –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ...
    "orderLinkId": order_link_id,  # CRITICAL: Idempotency key
}
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:**  
Bybit API –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `orderLinkId`, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ —Ä–µ—Ç—Ä–∞—è—Ö.

---

### ‚úÖ 2. MUTABLE DEFAULTS –í PYDANTIC –ú–û–î–ï–õ–Ø–•

**üìç –§–∞–π–ª:** `src/hean/core/types.py`

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `metadata: dict[str, Any] = {}` –≤ –∫–ª–∞—Å—Å–∞—Ö `Signal`, `OrderRequest`, `Order`, `Position` —Å–æ–∑–¥–∞–≤–∞–ª–æ –æ–±—â–∏–π –æ–±—ä–µ–∫—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –≤—Å–µ—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤.

**üí• –†–∏—Å–∫:**  
–ò–∑–º–µ–Ω–µ–Ω–∏–µ `metadata` –≤ –æ–¥–Ω–æ–º —Å–∏–≥–Ω–∞–ª–µ –≤–ª–∏—è–ª–æ –Ω–∞ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã, –≤—ã–∑—ã–≤–∞—è —É—Ç–µ—á–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

**‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# –ë–´–õ–û:
metadata: dict[str, Any] = {}

# –°–¢–ê–õ–û:
metadata: dict[str, Any] = Field(default_factory=dict)
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:**  
–ö–∞–∂–¥—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å, –∏–∑–æ–ª—è—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–∞–º–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞.

---

### ‚úÖ 3. –ó–ê–©–ò–¢–ê EVENTBUS –û–¢ MEMORY LEAK

**üìç –§–∞–π–ª:** `src/hean/core/bus.py`

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞:**  
–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å–æ–±—ã—Ç–∏–π (`asyncio.Queue()` –±–µ–∑ `maxsize`) –º–æ–≥–ª–∞ —Ä–∞—Å—Ç–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.

**üí• –†–∏—Å–∫:**  
–ü—Ä–∏ –∑–∞–º–µ–¥–ª–µ–Ω–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –æ—á–µ—Ä–µ–¥—å –º–æ–≥–ª–∞ –≤—ã—Ä–∞—Å—Ç–∏ –¥–æ –≥–∏–≥–∞–±–∞–π—Ç –ø–∞–º—è—Ç–∏, –ø—Ä–∏–≤–æ–¥—è –∫ OOM-–∫—Ä–∞—à–∞–º.

**‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ—á–µ—Ä–µ–¥–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000 —Å–æ–±—ã—Ç–∏–π)
self._queue: asyncio.Queue[Event] = asyncio.Queue(maxsize=max_queue_size)

# –ó–∞—â–∏—Ç–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
async def publish(self, event: Event) -> None:
    try:
        self._queue.put_nowait(event)
    except asyncio.QueueFull:
        raise RuntimeError(
            f"EventBus queue full ({self._queue.qsize()}/{self._queue.maxsize}). "
            "Event processing is falling behind."
        )
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:**  
–û—á–µ—Ä–µ–¥—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ 10000 —Å–æ–±—ã—Ç–∏—è–º–∏. –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —è–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –≤–º–µ—Å—Ç–æ silent drop, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

### ‚úÖ 4. SYNCHRONOUS HANDLERS –í THREAD POOL

**üìç –§–∞–π–ª:** `src/hean/core/bus.py`

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞:**  
–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –Ω–∞–ø—Ä—è–º—É—é –≤ event loop, –±–ª–æ–∫–∏—Ä—É—è –æ–±—Ä–∞–±–æ—Ç–∫—É –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π.

**üí• –†–∏—Å–∫:**  
–ú–µ–¥–ª–µ–Ω–Ω—ã–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–≥ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å event loop, –∑–∞–º–æ—Ä–æ–∑–∏–≤ —Ç–æ—Ä–≥–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.

**‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# Thread pool –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
self._executor = concurrent.futures.ThreadPoolExecutor(
    max_workers=4, thread_name_prefix="EventBus-SyncHandler"
)

async def _safe_call_handler(self, handler, event):
    if asyncio.iscoroutinefunction(handler):
        await handler(event)
    else:
        # –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ thread pool
        loop = asyncio.get_event_loop()
        await loop.run_in_executor(self._executor, handler, event)
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:**  
–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç event loop, —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∑—ã–≤—á–∏–≤–æ–π –¥–∞–∂–µ –ø—Ä–∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö.

---

### ‚úÖ 5. SYMBOL RULES –ò–ó API (–ù–ï –î–ï–§–û–õ–¢–´)

**üìç –§–∞–π–ª—ã:** 
- `src/hean/exchange/bybit/http.py` (–º–µ—Ç–æ–¥ `get_instrument_info`)
- `src/hean/process_factory/integrations/bybit_actions.py`

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è `minQty`, `qtyStep`, `minNotional` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ API.

**üí• –†–∏—Å–∫:**  
–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π sizing –æ—Ä–¥–µ—Ä–æ–≤, –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç –±–∏—Ä–∂–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏ –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

**‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ BybitHTTPClient
async def get_instrument_info(self, symbol: str) -> dict[str, Any]:
    """Fetches real symbol rules from Bybit API v5 /v5/market/instruments-info"""
    response = await self._request("GET", "/v5/market/instruments-info", params=params)
    # –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –∏–∑ –æ—Ç–≤–µ—Ç–∞ API
    rules = {
        "minQty": float(lot_size_filter.get("minQty")),
        "qtyStep": float(lot_size_filter.get("qtyStep")),
        "minNotional": float(lot_size_filter.get("minNotional")),
        # ...
    }
    return rules

# –í bybit_actions.py - –∑–∞–ø—Ä–µ—Ç –¥–µ—Ñ–æ–ª—Ç–æ–≤
async def get_symbol_rules(self, symbol: str) -> dict[str, Any]:
    try:
        rules = await self._client.get_instrument_info(symbol)
        return rules
    except Exception as e:
        # CRITICAL: –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ—Ñ–æ–ª—Ç—ã, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
        raise ValueError(f"Cannot fetch symbol rules for {symbol}. API error: {e}") from e
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:**  
–í—Å–µ symbol rules –ø–æ–ª—É—á–∞—é—Ç—Å—è –∏–∑ API. –ü—Ä–∏ –æ—à–∏–±–∫–µ API –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —è–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –≤–º–µ—Å—Ç–æ silent fallback –Ω–∞ –¥–µ—Ñ–æ–ª—Ç—ã.

---

### ‚úÖ 6. –ß–ï–¢–ö–ê–Ø –ì–†–ê–ù–ò–¶–ê SIMULATION/LIVE

**üìç –§–∞–π–ª:** `src/hean/exchange/bybit/http.py`

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞:**  
–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —è–≤–Ω—ã—Ö –∑–∞—â–∏—Ç–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ –º–µ—Ç–æ–¥–∞—Ö `place_order()` –∏ `cancel_order()` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö API-–≤—ã–∑–æ–≤–æ–≤ –≤ simulation mode.

**üí• –†–∏—Å–∫:**  
–ë–∞–≥–∏ –≤ routing logic –º–æ–≥–ª–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–ª—É—á–∞–π–Ω—ã–º —Ä–µ–∞–ª—å–Ω—ã–º –æ—Ä–¥–µ—Ä–∞–º –≤ simulation mode.

**‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
async def place_order(self, order_request: OrderRequest) -> Order:
    # CRITICAL: Defensive check - prevent real API calls in simulation mode
    if settings.dry_run:
        raise RuntimeError(
            "CRITICAL: Cannot place real orders when DRY_RUN=true. "
            "This is a simulation mode - use PaperBroker instead."
        )
    if not settings.is_live:
        raise RuntimeError(
            "CRITICAL: Cannot place orders when live trading is not enabled."
        )
    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:**  
–†–µ–∞–ª—å–Ω—ã–µ API-–≤—ã–∑–æ–≤—ã —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã –≤ simulation mode. –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞: –Ω–∞ —É—Ä–æ–≤–Ω–µ ExecutionRouter (routing) –∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ BybitHTTPClient (defensive checks).

---

## –§–ò–ù–ê–õ: –ö–ê–ö –¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢ –°–ò–°–¢–ï–ú–ê

### SIMULATION MODE (DRY_RUN=true)

- ‚úÖ –í—Å–µ –æ—Ä–¥–µ—Ä–∞ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `PaperBroker`
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Bybit API
- ‚úÖ PnL, –ø–æ–∑–∏—Ü–∏–∏, SL/TP —Å—á–∏—Ç–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –ó–∞—â–∏—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `BybitHTTPClient` –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è

### LIVE MODE (DRY_RUN=false, LIVE_CONFIRM=YES, trading_mode=live)

- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `BybitHTTPClient`
- ‚úÖ –ö–∞–∂–¥—ã–π –æ—Ä–¥–µ—Ä –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `orderLinkId` –¥–ª—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ Symbol rules –ø–æ–ª—É—á–∞—é—Ç—Å—è –∏–∑ API, –Ω–∏–∫–∞–∫–∏—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç live mode –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º
- ‚úÖ –Ø–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞ –≤ simulation mode

### –ì–†–ê–ù–ò–¶–ê –î–ï–ù–ï–ì

**–ì—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤ `ExecutionRouter._handle_order_request()`:**
```python
if not settings.dry_run and settings.is_live and self._bybit_http:
    # LIVE MODE - —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏
    await self._route_to_bybit(order_request)
else:
    # SIMULATION MODE - –±—É–º–∞–∂–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è
    await self._route_to_paper(order_request)
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –≤ `BybitHTTPClient`:**
- –ú–µ—Ç–æ–¥—ã `place_order()` –∏ `cancel_order()` –ø—Ä–æ–≤–µ—Ä—è—é—Ç `dry_run` –∏ `is_live`
- –ü—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –≥—Ä–∞–Ω–∏—Ü—ã –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `RuntimeError` —Å —è–≤–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º

---

## –ì–ê–†–ê–ù–¢–ò–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### ‚úÖ –ü–æ—á–µ–º—É —Ç–µ–ø–µ—Ä—å –ù–ï–¢ –¥–≤–æ–π–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤:

1. **orderLinkId –¥–ª—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏:** –ö–∞–∂–¥—ã–π –æ—Ä–¥–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `orderLinkId` —Ñ–æ—Ä–º–∞—Ç–∞ `{strategy_id}_{symbol}_{timestamp_ms}_{random}`
2. **Bybit API –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã:** –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å —Ç–µ–º –∂–µ `orderLinkId` –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –±–∏—Ä–∂–µ–π
3. **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ä–µ—Ç—Ä–∞–∏:** –°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ –Ω–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –æ—Ä–¥–µ—Ä–æ–≤

### ‚úÖ –ü–æ—á–µ–º—É —Ç–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–Ω—ã —Ä–µ—Ç—Ä–∞–∏:

1. **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ orderLinkId:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º –∂–µ `orderLinkId` –±–µ–∑–æ–ø–∞—Å–µ–Ω
2. **–ó–∞—â–∏—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ API:** Bybit API –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `orderLinkId`
3. **–ù–µ—Ç —Ä–∏—Å–∫–∞ –¥–≤–æ–π–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:** –î–∞–∂–µ –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ—Ç—Ä–∞—è—Ö –æ—Ä–¥–µ—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑

### ‚úÖ –ü–æ—á–µ–º—É —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω sizing:

1. **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API:** Symbol rules –ø–æ–ª—É—á–∞—é—Ç—Å—è –∏–∑ `/v5/market/instruments-info`
2. **–ù–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤:** –ü—Ä–∏ –æ—à–∏–±–∫–µ API –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —è–≤–Ω–∞—è –æ—à–∏–±–∫–∞
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö:** –í—Å–µ –æ—Ä–¥–µ—Ä–∞ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º –±–∏—Ä–∂–∏

---

## –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

- **–í—Å–µ–≥–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 6
- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 4
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–æ:** ~150
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ CRITICAL (–¥–µ–Ω—å–≥–∏, –æ—Ä–¥–µ—Ä–∞, —Ä–∏—Å–∫)

---

## –ü–†–û–í–ï–†–ö–ê –ü–ï–†–ï–î –î–ï–ü–õ–û–ï–ú

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –≤ –ø—Ä–æ–¥–∞–∫—à–Ω —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –≤ simulation mode (DRY_RUN=true)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –≤ live mode –Ω–∞ testnet (bybit_testnet=true, LIVE_CONFIRM=YES)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (—Ä–µ—Ç—Ä–∞–∏ —Å —Ç–µ–º –∂–µ orderLinkId)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ symbol rules –∏–∑ API
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ –≤ simulation mode

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ö–û–ù–¢–†–û–õ–ò–†–£–ï–ú–û–ú–£ PRODUCTION

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–µ–Ω—å–≥–∞–º–∏ –ø—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

